# 디렉터리 자동 정리 스크립트

이 스크립트는 지정된 디렉터리 내의 숫자로 이름 지어진 폴더를 관리하는 자동화 도구입니다. 폴더 수가 설정된 목표 개수를 초과하면 가장 작은 숫자의 폴더부터 삭제하여 지정된 개수만 유지합니다.

## 기능

- 여러 디렉터리 경로를 한 번에 처리
- 숫자로 된 폴더만 선택적으로 관리
- 목표 디렉터리 수 설정 가능
- 상세한 로그 기록
- 테스트 모드 지원 (실제 삭제 없이 계획만 확인)
- 컬러 출력으로 가독성 향상

## 요구사항

- Bash 쉘 환경 (macOS, Linux)
- 실행 권한 (`chmod +x auto-delete-directories.sh`)

## 설치

1. 스크립트 파일을 다운로드합니다.
2. 실행 권한을 부여합니다:
```bash
chmod +x auto-delete-directories.sh
```

## 사용법

### 기본 사용법

```shell
bash auto-delete-directories.sh [옵션] 디렉터리1 [디렉터리2 ...]
```

### 옵션

- `-t, --target NUM`: 유지할 목표 디렉터리 수 (기본값: 10)
- `-l, --log FILE`: 로그 파일 경로 (기본값: ./cleanup.log)
- `-d, --dry-run`: 테스트 모드 (실제 삭제 없이 계획만 표시)
- `-h, --help`: 도움말 메시지 표시

### 예시

기본 실행 (목표 디렉터리 수 10개):
```shell
bash auto-delete-directories.sh /path/to/dir1
```

목표 디렉터리 수 변경:
```shell
bash auto-delete-directories.sh -t 5 /path/to/dir1
```

여러 디렉터리 처리:
```shell
bash auto-delete-directories.sh /path/to/dir1 /path/to/dir2 /path/to/dir3
```

테스트 모드 실행 (삭제 없이 계획만 확인):
```shell
bash auto-delete-directories.sh --dry-run /path/to/dir1
```

로그 파일 위치 지정:
```shell
bash auto-delete-directories.sh -l /var/log/cleanup.log /path/to/dir1
```

## 자동화 설정 (크론탭)

매일 오전 6시에 자동 실행되도록 크론탭에 등록:

```shell
# crontab -e 명령으로 크론탭 편집기 열기
0 6 * * * /path/to/auto-delete-directories.sh -t 10 /path/to/dir1 /path/to/dir2 >> /tmp/cleanup_cron.log 2>&1
```

## 동작 방식

1. 지정된 디렉터리 내의 모든 하위 디렉터리를 검색합니다.
2. 숫자로만 구성된 디렉터리 이름을 필터링합니다.
3. 해당 디렉터리들을 숫자 값에 따라 오름차순으로 정렬합니다.
4. 디렉터리 수가 목표치를 초과하면, 가장 작은 숫자의 디렉터리부터 삭제합니다.
5. 결과를 로그 파일과 터미널에 출력합니다.

## 주의사항

- 삭제 작업은 복구가 불가능합니다. 처음 사용 시 `--dry-run` 옵션으로 테스트하는 것을 권장합니다.
- 스크립트는 지정된 디렉터리 내의 숫자 이름 폴더만 관리합니다.
- 로그 파일이 위치한 디렉터리에 쓰기 권한이 있어야 합니다.
- 대용량 디렉터리 처리 시 시간이 소요될 수 있습니다.

## 로그 출력 예시

```shell
2025-04-14 08:51:23 - [INFO] 스크립트 시작: 유지할 목표 디렉터리 수=3
2025-04-14 08:51:23 - [INFO] 처리할 최상위 디렉터리 수: 2
2025-04-14 08:51:23 - [INFO] 최상위 디렉터리 처리 중: ./test02
2025-04-14 08:51:23 - [INFO] 전체 하위 디렉터리 수: 12
2025-04-14 08:51:23 - [INFO] 숫자 디렉터리 수: 12 (숫자 아닌 디렉터리: 0)
2025-04-14 08:51:23 - [INFO] 숫자 디렉터리 목록 (오름차순): 113, 114, 115, 119, 120, ... , 302, 303, 310
2025-04-14 08:51:23 - [WARNING] 삭제 필요: 9 개 (총 12 중 3 개만 유지)
2025-04-14 08:51:23 - [WARNING] 삭제 대상 디렉터리: 113, 114, 115, 119, 120, 130, 135, 300, 301
2025-04-14 08:51:23 - [SUCCESS] 삭제 작업 완료: 9 개 삭제됨 (남은 디렉터리: 3)
```